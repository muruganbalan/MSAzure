{
	"name": "DF_SCD_TYPE1",
	"properties": {
		"type": "MappingDataFlow",
		"typeProperties": {
			"sources": [
				{
					"dataset": {
						"referenceName": "DS_ASQL_SRC_CUSTOMER",
						"type": "DatasetReference"
					},
					"name": "srcoltp"
				},
				{
					"dataset": {
						"referenceName": "DS_ASQL_TGT_CUSTOMER",
						"type": "DatasetReference"
					},
					"name": "lkpsrcolap"
				}
			],
			"sinks": [],
			"transformations": [
				{
					"name": "rename"
				},
				{
					"name": "createsrchash"
				},
				{
					"name": "lkptgtolap"
				},
				{
					"name": "selectrequired"
				},
				{
					"name": "newvsold"
				}
			],
			"script": "source(output(\n\t\tid as integer,\n\t\tname as string,\n\t\tage as integer,\n\t\taddress as string,\n\t\tphone as integer\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> srcoltp\nsource(output(\n\t\tid as integer,\n\t\tname as string,\n\t\tage as integer,\n\t\taddress as string,\n\t\tphone as integer,\n\t\t{_Inserted} as timestamp,\n\t\t{_LastUpdated} as timestamp,\n\t\tDWHash as string\n\t),\n\tallowSchemaDrift: true,\n\tvalidateSchema: false,\n\tisolationLevel: 'READ_UNCOMMITTED',\n\tformat: 'table') ~> lkpsrcolap\nsrcoltp select(mapColumn(\n\t\tsrc_id = id,\n\t\tsrc_name = name,\n\t\tsrc_age = age,\n\t\tsrc_address = address,\n\t\tsrc_phone = phone\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> rename\nrename derive(src_dwhash = sha2(256,src_age+src_phone)) ~> createsrchash\ncreatesrchash, lkpsrcolap lookup(src_id == id,\n\tmultiple: false,\n\tpickup: 'any',\n\tbroadcast: 'none')~> lkptgtolap\nlkptgtolap select(mapColumn(\n\t\tsrc_id,\n\t\tsrc_name,\n\t\tsrc_age,\n\t\tsrc_address,\n\t\tsrc_phone,\n\t\tsrc_dwhash,\n\t\tid\n\t),\n\tskipDuplicateMapInputs: true,\n\tskipDuplicateMapOutputs: true) ~> selectrequired\nselectrequired split(ERROR_FUNCTION(''),\n\tdisjoint: false) ~> newvsold@(, )"
		}
	}
}